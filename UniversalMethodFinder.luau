local a=getgenv and getgenv()or _G or shared;local b={_G,shared}local c={}a.globalcontainer=c;if getgenv then table.insert(b,getgenv())end;local a={}local d=0;local e,f;local function g(b)if d>=16379 then return end;for a,a in ipairs(a)do if a==b then return end end;table.insert(a,b)d+=1;for a,b in next,b do if type(b)=="table"then g(b)elseif type(b)=="function"then a=tostring(a):lower()for d,e in next,e do e="return "..e;if loadstring(e)(a)then c[d]=b;if f then print(d,a)end end end end end;d-=1 end;local function h(h,i,j)if i then i=nil else local a={}for b,d in next,h do if not c[b]then a[b]=d;i=true end end;if not i then return end;h=a end;e=h;f=j;table.clear(a)d=0;g(b)e=nil;f=nil end;return h,c
